version: "3.1"

services:
  ssh-agent:
    build:
      context: .
      dockerfile: ssh.Dockerfile
    volumes:
      - ~/.ssh:/.ssh
      - ssh-sock:/.ssh-agent/

  service:
    build:
      dockerfile: Dockerfile
      context: .
    volumes:
      - ssh-sock:/.ssh-agent/
    environment:
      - SSH_AUTH_SOCK=/.ssh-agent/socket
    command: ssh -o StrictHostKeyChecking=no git@github.com

volumes:
  ssh-sock:
